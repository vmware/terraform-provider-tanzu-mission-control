---
Title: "Custom IAM Role Resource"
Description: |-
   Creating a custom IAM role.
---

# Custom IAM Role Resource

This resource enables users to create custom IAM roles in TMC.

For more information regarding custom roles, see [Custom Role][custom-role].

[custom-role]: https://docs.vmware.com/en/VMware-Tanzu-Mission-Control/services/tanzumc-using/GUID-F314ED9E-2736-48CC-A1BB-CB9C32900B30.html

## Example Usage

```terraform
resource "tanzu-mission-control_custom_iam_role" "demo-role" {
  name = "tf-custom-role"

  spec {
    is_deprecated = false

    aggregation_rule {
      cluster_role_selector {
        match_labels = {
          key = "value"
        }
      }

      cluster_role_selector {
        match_expression {
          key      = "aa"
          operator = "Exists"
          values   = ["aa", "bb", "cc"]
        }
      }
    }

    resources = [
      "ORGANIZATION",
      "CLUSTER_GROUP",
      "CLUSTER"
    ]

    tanzu_permissions = []

    rule {
      resources  = ["deployments"]
      verbs      = ["get", "list"]
      api_groups = ["*"]
    }

    rule {
      verbs      = ["get", "list"]
      api_groups = ["*"]
      url_paths  = ["/healthz"]
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the iam role
- `spec` (Block List, Min: 1, Max: 1) Spec block of iam role (see [below for nested schema](#nestedblock--spec))

### Optional

- `meta` (Block List, Max: 1) Metadata for the resource (see [below for nested schema](#nestedblock--meta))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--spec"></a>
### Nested Schema for `spec`

Required:

- `resources` (List of String) The resources for the iam role.
Valid values are (ORGANIZATION, MANAGEMENT_CLUSTER, PROVISIONER, CLUSTER_GROUP, CLUSTER, WORKSPACE, NAMESPACE)
- `rule` (Block List, Min: 1) Kubernetes rules. (see [below for nested schema](#nestedblock--spec--rule))

Optional:

- `aggregation_rule` (Block List, Max: 1) Aggregation rules for the iam role. (see [below for nested schema](#nestedblock--spec--aggregation_rule))
- `is_deprecated` (Boolean) Flag representing whether role is deprecated.
- `tanzu_permissions` (List of String) Tanzu-specific permissions for the role.

<a id="nestedblock--spec--rule"></a>
### Nested Schema for `spec.rule`

Required:

- `verbs` (List of String) Verbs.

Optional:

- `api_groups` (List of String) API groups.
- `resource_names` (List of String) Restricts the rule to resources by name.
- `resources` (List of String) Resources for the role.
- `url_paths` (List of String) Non-resource urls for the role.


<a id="nestedblock--spec--aggregation_rule"></a>
### Nested Schema for `spec.aggregation_rule`

Required:

- `cluster_role_selector` (Block List, Min: 1) Cluster role selector for the iam role. (see [below for nested schema](#nestedblock--spec--aggregation_rule--cluster_role_selector))

<a id="nestedblock--spec--aggregation_rule--cluster_role_selector"></a>
### Nested Schema for `spec.aggregation_rule.cluster_role_selector`

Optional:

- `match_expression` (Block List) List of label selector requirements.
The requirements are ANDed. (see [below for nested schema](#nestedblock--spec--aggregation_rule--cluster_role_selector--match_expression))
- `match_labels` (Map of String) Map of {key,value} pairs.
A single {key,value} in the match_labels map is equivalent to an element of match_expression, whose key field is "key", the operator is "In", and the values array contains only "value". 
The requirements are ANDed.

<a id="nestedblock--spec--aggregation_rule--cluster_role_selector--match_expression"></a>
### Nested Schema for `spec.aggregation_rule.cluster_role_selector.match_expression`

Required:

- `key` (String) Key is the label key that the selector applies to.
- `operator` (String) Operator represents a key's relationship to a set of values.
Valid operators are "In", "NotIn", "Exists" and "DoesNotExist".

Optional:

- `values` (List of String) Values is an array of string values.
If the operator is "In" or "NotIn", the values array must be non-empty.
If the operator is "Exists" or "DoesNotExist", the values array must be empty.
This array is replaced during a strategic merge patch.





<a id="nestedblock--meta"></a>
### Nested Schema for `meta`

Optional:

- `annotations` (Map of String) Annotations for the resource
- `description` (String) Description of the resource
- `labels` (Map of String) Labels for the resource

Read-Only:

- `resource_version` (String) Resource version of the resource
- `uid` (String) UID of the resource
